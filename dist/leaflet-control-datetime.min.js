!function(a,b,c,d,e){"use strict";console===e&&(this.console={log:function(){}}),b.Control.Datetime=b.Control.extend({options:{VERSION:"1.0.0",datetimes:[],callback:null,title:null,language:null,position:"topright",visibility:"visible",vertical:!1,localtime:!1,prefetch:!1,mobile:!1,initialDatetime:null},initialize:function(c){b.Util.setOptions(this,c),this._container=b.DomUtil.create("div","leaflet-control-layers leaflet-control-layers-expanded leaflet-control-datetime"),this.options.mobile&&a(this._container).addClass("leaflet-control-datetime-mobile"),"hidden"==this.options.visibility&&a(this._container).css("visibility",this.options.visibility),a(this._container).addClass("hide-on-print"),b.DomEvent.disableClickPropagation(this._container),this._createDatetimeSelector(this._container)},onAdd:function(a){this._map=a,this._map.on("overlayadd overlayremove",this._layersChanged,this);var b="utc";return this._timezone[0].checked&&(b="local"),a.fire("timezonechange",{timezone:b}),this._container},onRemove:function(){this._container.style.display="none",this._map.off("overlayadd overlayremove",this._layersChanged,this),this._map=null},_createDatetimeSelector:function(c){function e(a){var b=Math.abs(Math.floor(a));return(10>b?"0":"")+b}function f(){var a=new Date,b=-a.getTimezoneOffset(),c=b>=0?"+":"-";return c+e(b/60)+":"+e(b%60)}var g=this;if(this.options.title){var h=b.DomUtil.create("div","leaflet-control-datetime-title",c);h.innerHTML=this.options.title}var i=b.DomUtil.create("select","leaflet-control-datetime-dateselect",c);i._instance=this;for(var j=null,k=0;k<this.options.datetimes.length;k++){var l=d.createElement("option"),m=this.options.datetimes[k];l.value=m.toISOString();var n=moment(m);null!==this.options.language&&n.locale(this.options.language),n=n.format("LLLL"),n=n.charAt(0).toUpperCase()+n.slice(1),a(l).text(n),i.appendChild(l),null!==this.options.initialDatetime&&this.options.initialDatetime.valueOf()==m.valueOf()&&(j=k,null!==this.options.callback&&this.options.callback("datetime",l.value))}null===j&&(j=this._getNowIndex(),null!==this.options.callback&&null!==j&&this.options.callback("datetime",i.options[j].value)),i.onchange=this._datetimeChanged,i.selectedIndex=j;var o=a(b.DomUtil.create("div","leaflet-control-datetime-sliderdiv",c));o.slider({"class":"leaflet-control-datetime-slider",min:0,max:this.options.datetimes.length-1,value:j,slide:this._sliderChanged});var p=a('<div id="leaflet-control-datetime-range"></div>');o.append(p);var q=b.DomUtil.create("div","leaflet-control-datetime-buttondiv",c),r=a('<button class="btn btn-default btn-lg"><i class="fa fa-fast-backward"></i></button>');r.click(this._datetimeStart),r.appendTo(q);var s=a('<button class="btn btn-default btn-lg"><i class="fa fa-step-backward"></i></button>');s.click(this._datetimeBack),s.appendTo(q);var t=this._("Now");t='<button class="btn btn-default btn-lg"><span class="fa">'+t+"</span></button>";var u=a(t);u.click(this._datetimeNow),u.appendTo(q);var v=a('<button class="btn btn-default btn-lg"><i class="fa fa-step-forward"></i></button>');v.click(this._datetimeForward),v.appendTo(q);var w=a('<button class="btn btn-default btn-lg"><i class="fa fa-fast-forward"></i></button>');w.click(this._datetimeEnd),w.appendTo(q);var x=a("<input>",{type:"checkbox",checked:"checked","class":"leaflet-control-datetime-localtime-checkbox"});this._timezone=x;var y=this.options.callback;x.click(function(){for(var b=a(".leaflet-control-datetime-dateselect")[0],c=b._instance.options.datetimes,d=0;d<c.length;d++){var e=moment(c[d]);null!==b._instance.options.language&&e.locale(b._instance.options.language),this.checked?(e=e.format("LLLL"),e=e.charAt(0).toUpperCase()+e.slice(1),b.options[d].text=e):(e=e.utcOffset("+0000").format("LLLL"),e=e.charAt(0).toUpperCase()+e.slice(1),b.options[d].text=e+" GMT")}y&&"function"==typeof y&&y("timezone",this.checked);var f="utc";this.checked&&(f="local"),g._map.fire("timezonechange",{timezone:f})}),x._instance=this;var z=a("<label>"),A=this._("Use local time")+" (GMT"+f()+")",B=z.append(x).append(a("<span>"+A+"</span>")),C=a("<div>",{"class":"leaflet-control-datetime-localtime"}).append(B);C.appendTo(c)},_layersChanged:function(){var b=this.options.datetimes,c=b[b.length-1],d=b[0];this._map.eachLayer(function(a){if(a._overlay!==e&&a._overlay===!0&&a.timesteps!==e){var b=a.timesteps;null!==b&&b.length>1&&(c=b[0]<c?b[0]:c,d=b[b.length-1]>d?b[b.length-1]:d)}});var f,g,h=1e10,i=null;for(f in b)g=Math.abs(c-b[f]),h>g&&(h=g,i=parseInt(f));h=1e10;var j=null;for(f in b)g=Math.abs(d-b[f]),h>g&&(h=g,j=parseInt(f));var k=a("#leaflet-control-datetime-range");if(j>i){var l=b.length-1,m=i/l*100,n=j/l*100,o=n-m;k.css({"margin-left":m+"%",width:o+"%"})}else k.css({"margin-left":"",width:""})},_datetimeUpdate:function(a){var b=a.options[a.selectedIndex].value;this.options.callback&&"function"==typeof this.options.callback&&this.options.callback("datetime",b)},_datetimeChanged:function(){var b=a("select.leaflet-control-datetime-dateselect")[0],c=b._instance,d=b.selectedIndex;a(".leaflet-control-datetime-sliderdiv").slider("value",d),c._datetimeUpdate(b)},_sliderChanged:function(b,c){var d=a("select.leaflet-control-datetime-dateselect")[0],e=Math.max(Math.min(c.value,d.length-1),0);d.selectedIndex=e,c.value=e;var f=d._instance;f._datetimeUpdate(d)},_datetimeStart:function(){var b=0,c=a("select.leaflet-control-datetime-dateselect")[0];c.selectedIndex=b,a(".leaflet-control-datetime-sliderdiv").slider("value",b);var d=c._instance;d._datetimeUpdate(c)},_datetimeBack:function(){var b=a("select.leaflet-control-datetime-dateselect")[0],c=Math.max(b.selectedIndex-1,0);b.selectedIndex=c,a(".leaflet-control-datetime-sliderdiv").slider("value",c);var d=b._instance;d._datetimeUpdate(b)},_datetimeNow:function(){var b=a("select.leaflet-control-datetime-dateselect")[0],c=b._instance,d=c._getNowIndex();b.selectedIndex=d,a(".leaflet-control-datetime-sliderdiv").slider("value",d),c._datetimeUpdate(b)},_getNowIndex:function(){var a,b=this.options.datetimes,c=new Date,d=1e10,e=null;for(a in b){var f=Math.abs(c-b[a]);d>f&&(d=f,e=a)}return e},_datetimeForward:function(){var b=a("select.leaflet-control-datetime-dateselect")[0],c=Math.min(b.selectedIndex+1,b.length-1);b.selectedIndex=c,a(".leaflet-control-datetime-sliderdiv").slider("value",c);var d=b._instance;d._datetimeUpdate(b),d.options.prefetch&&c<b.length-2&&d._map.eachLayer(function(a){if(a._overlay!==e&&a._overlay===!0&&a.timesteps!==e){var d=a.timesteps;if(null!==d&&d.length>1){var f={time:b.options[c+1].value};a.prefetch(f)}}})},_datetimeEnd:function(){var b=a("select.leaflet-control-datetime-dateselect")[0],c=b.length-1;b.selectedIndex=c,a(".leaflet-control-datetime-sliderdiv").slider("value",c);var d=b._instance;d._datetimeUpdate(b)},_datetimeAnimate:function(){},_:function(a){var b=this.options.language,c={en:{"Use local time":"Use local time",Now:"Now"},da:{"Use local time":"Brug lokal tid",Now:"Nu"}};return c[b]!==e&&c[b][a]!==e?c[b][a]:a}}),b.Control.datetime=function(a){return new b.Control.Datetime(a)}}(jQuery,L,this,document);